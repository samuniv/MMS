@page "{id:int}"
@model MeetingManagementSystem.Web.Pages.Meetings.EditModel
@{
    ViewData["Title"] = "Edit Meeting";
}

<div class="mb-6">
    <h1 class="text-3xl font-bold">Edit Meeting</h1>
    <p class="text-base-content/70">Update meeting details</p>
</div>

<div class="card bg-base-100 shadow max-w-4xl">
    <div class="card-body">
        <form method="post">
            <div asp-validation-summary="ModelOnly" class="alert alert-error mb-4" role="alert"></div>
            
            <!-- Meeting Details -->
            <div class="form-control mb-4">
                <label asp-for="Input.Title" class="label">
                    <span class="label-text font-semibold">Meeting Title <span class="text-error">*</span></span>
                </label>
                <input asp-for="Input.Title" class="input input-bordered" />
                <span asp-validation-for="Input.Title" class="label-text-alt text-error"></span>
            </div>
            
            <div class="form-control mb-4">
                <label asp-for="Input.Description" class="label">
                    <span class="label-text font-semibold">Description</span>
                </label>
                <textarea asp-for="Input.Description" class="textarea textarea-bordered h-24"></textarea>
                <span asp-validation-for="Input.Description" class="label-text-alt text-error"></span>
            </div>
            
            <!-- Date and Time -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div class="form-control">
                    <label asp-for="Input.ScheduledDate" class="label">
                        <span class="label-text font-semibold">Date <span class="text-error">*</span></span>
                    </label>
                    <input asp-for="Input.ScheduledDate" type="date" class="input input-bordered" />
                    <span asp-validation-for="Input.ScheduledDate" class="label-text-alt text-error"></span>
                </div>
                
                <div class="form-control">
                    <label asp-for="Input.StartTime" class="label">
                        <span class="label-text font-semibold">Start Time <span class="text-error">*</span></span>
                    </label>
                    <input asp-for="Input.StartTime" type="time" class="input input-bordered" />
                    <span asp-validation-for="Input.StartTime" class="label-text-alt text-error"></span>
                </div>
                
                <div class="form-control">
                    <label asp-for="Input.EndTime" class="label">
                        <span class="label-text font-semibold">End Time <span class="text-error">*</span></span>
                    </label>
                    <input asp-for="Input.EndTime" type="time" class="input input-bordered" />
                    <span asp-validation-for="Input.EndTime" class="label-text-alt text-error"></span>
                </div>
            </div>
            
            <!-- Room and Status -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div class="form-control">
                    <label asp-for="Input.MeetingRoomId" class="label">
                        <span class="label-text font-semibold">Meeting Room</span>
                    </label>
                    <select asp-for="Input.MeetingRoomId" class="select select-bordered">
                        <option value="">No room selected</option>
                        @foreach (var room in Model.AvailableRooms)
                        {
                            <option value="@room.Id">@room.Name - @room.Location (Capacity: @room.Capacity)</option>
                        }
                    </select>
                    <span asp-validation-for="Input.MeetingRoomId" class="label-text-alt text-error"></span>
                </div>
                
                <div class="form-control">
                    <label asp-for="Input.Status" class="label">
                        <span class="label-text font-semibold">Status</span>
                    </label>
                    <select asp-for="Input.Status" class="select select-bordered">
                        <option value="Scheduled">Scheduled</option>
                        <option value="InProgress">In Progress</option>
                        <option value="Completed">Completed</option>
                        <option value="Cancelled">Cancelled</option>
                    </select>
                </div>
            </div>
            
            <!-- Participants -->
            <div class="form-control mb-6">
                <label class="label">
                    <span class="label-text font-semibold">Participants</span>
                </label>
                <div class="border border-base-300 rounded-lg p-4 max-h-64 overflow-y-auto">
                    @if (Model.Users.Any())
                    {
                        @foreach (var user in Model.Users)
                        {
                            <div class="form-control">
                                <label class="label cursor-pointer justify-start gap-3">
                                    <input type="checkbox" 
                                           name="Input.ParticipantIds" 
                                           value="@user.Id" 
                                           checked="@Model.Input.ParticipantIds.Contains(user.Id)"
                                           class="checkbox checkbox-primary" />
                                    <div class="flex-1">
                                        <span class="label-text font-medium">@user.FirstName @user.LastName</span>
                                        <span class="label-text-alt block">@user.Department - @user.Position</span>
                                    </div>
                                </label>
                            </div>
                        }
                    }
                </div>
            </div>
            
            <!-- Actions -->
            <div class="flex gap-2">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    Save Changes
                </button>
                <a asp-page="Details" asp-route-id="@Model.MeetingId" class="btn btn-ghost">
                    Cancel
                </a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
